<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://skoczen.github.io/will/plugins/reply/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>How Will Can Respond</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/style.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Will</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Get Started</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Teach Your Will <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../basics/">The Basics</a>
                        </li>
                    
                        <li >
                            <a href="../notice/">What Will Can Notice</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">How Will Can Respond</a>
                        </li>
                    
                        <li >
                            <a href="../create/">Creating and Organizing Plugins</a>
                        </li>
                    
                        <li >
                            <a href="../builtins/">Plugin Builtins</a>
                        </li>
                    
                        <li >
                            <a href="../bundled/">Bundled Plugins</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../config/">Configure</a>
                </li>
            
            
            
                <li >
                    <a href="../../deploy/">Deploy</a>
                </li>
            
            
            
                <li >
                    <a href="../../improve/">Improve</a>
                </li>
            
            
            
                <li >
                    <a href="../../roadmap/">Roadmap</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../notice/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../create/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/skoczen/will/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#how-will-can-respond">How will can respond</a></li>
        
            <li><a href="#talk-to-the-room">Talk to the room</a></li>
        
            <li><a href="#reply-with-a-mention">Reply with a mention</a></li>
        
            <li><a href="#talk-to-the-room-from-a-webhook">Talk to the room from a webhook</a></li>
        
            <li><a href="#send-an-email">Send an email</a></li>
        
            <li><a href="#schedule-a-reply-for-the-future">Schedule a reply for the future</a></li>
        
            <li><a href="#set-the-topic">Set the topic</a></li>
        
            <li><a href="#do-any-python-thing">Do any python thing</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="how-will-can-respond">How will can respond</h1>
<p>Will can respond in a variety of ways, and since he's pure python, your imagination is the limit.</p>
<h2 id="talk-to-the-room">Talk to the room</h2>
<p>Like any normal person, will can talk to the chat room, or in 1-1 chats.  To talk to the room in your plugins, you'll want to use the <code>self.say()</code> method.</p>
<pre><code class="python">@respond_to(&quot;bonjour&quot;)
def say_bonjour_will(self, message):
    # Awesome stuff
    self.say(&quot;Bonjour!&quot;, message=message)
</code></pre>

<p><img alt="Bonjour!" src="../../img/only_bonjour.gif" /></p>
<p>Note that we pass <code>messsage</code> along.  This allows will to route his reply to the correct room.  Without it, he'll just speak to the <code>DEFAULT_ROOM</code>.</p>
<p><code>say()</code> comes with a number of options, including color, html, and ping notify. </p>
<pre><code class="python">self.say(content, message=None, room=None, html=False, color=&quot;green&quot;, notify=False)
</code></pre>

<ul>
<li><strong><code>content</code></strong>: the content you want to send to the room. Any string will do, HTML or plain text.</li>
<li><strong><code>message</code></strong>: (optional) The incoming message object</li>
<li><strong><code>room</code></strong>: (optional) The room object (from self.available_rooms) to send the message to.</li>
<li><strong><code>html</code></strong>: if the message is HTML. <code>True</code> or <code>False</code>.</li>
<li><strong><code>color</code></strong>: (chat room only) the hipchat color to send. "yellow", "red", "green", "purple", "gray", or "random". Default is "green". </li>
<li><strong><code>notify</code></strong>: whether the message should trigger a 'ping' notification. <code>True</code> or <code>False</code>.</li>
</ul>
<h2 id="reply-with-a-mention">Reply with a mention</h2>
<p>Sometimes you want will to ping you - that's where @name mentions are great.  To do those in will, you'll want to use <code>self.reply()</code></p>
<pre><code class="python">@respond_to(&quot;^hi&quot;)   # Basic
def hi(self, message):
    self.reply(message, &quot;hello, %s!&quot; % message.sender.nick)
</code></pre>

<p><img alt="Hi, Hello, username!" src="../../img/hi_hello.gif" /></p>
<p>Note the order of arguments is different here, and <code>messsage</code> is required. All the options: </p>
<pre><code class="python">self.reply(message, content, html=False, color=&quot;green&quot;, notify=False)
</code></pre>

<ul>
<li><strong><code>message</code></strong>: The incoming message object.  Required</li>
<li><strong><code>content</code></strong>: the content you want to send to the room. HTML or plain text.</li>
<li><strong><code>html</code></strong>: if the message is HTML. <code>True</code> or <code>False</code>.</li>
<li><strong><code>color</code></strong>: (chat room only) the hipchat color to send. "yellow", "red", "green", "purple", "gray", or "random". Default is "green".</li>
<li><strong><code>notify</code></strong>: whether the message should trigger a 'ping' notification. <code>True</code> or <code>False</code>.</li>
</ul>
<h2 id="talk-to-the-room-from-a-webhook">Talk to the room from a webhook</h2>
<p>When will recieves messages from webhooks and HTTP requests, he's still connected to chat, and you can use <code>.say()</code>. By default, he'll speak to <code>DEFAULT_ROOM</code>.</p>
<pre><code class="python">@route(&quot;/ping&quot;)
def ping(self):
    self.say(&quot;PONG!&quot;)
</code></pre>

<p>If you want to talk to a different room, you can pass in the <code>room</code> argument with one of the rooms from <code>self.available_rooms</code>.</p>
<h2 id="send-an-email">Send an email</h2>
<p>Will has one email backend at the moment, via <a href="http://www.mailgun.com">mailgun</a>.  If you've set <code>DEFAULT_FROM_EMAIL</code>, <code>MAILGUN_API_URL</code>, and <code>MAILGUN_API_KEY</code>, you can use <code>self.send_email()</code></p>
<pre><code class="python">@respond_to(&quot;status report&quot;)
def send_status_report(self):
    self.send_email(email_list=['jill@example.com'], subject=&quot;Here's the latest report&quot;, message=rendered_template(&quot;report.html&quot;, {}))
</code></pre>

<p>Here's all the options:</p>
<pre><code class="python">self.send_email(from_email=None, email_list=[], subject=&quot;&quot;, message=&quot;&quot;)
</code></pre>

<ul>
<li><strong><code>from_email</code></strong>: (Optional) The email address the message should come from. Defaults to <code>DEFAULT_FROM_EMAIL</code>.</li>
<li><strong><code>email_list</code></strong>: The list of addresses to send to.</li>
<li><strong><code>subject</code></strong>: (Optional) The email subject.</li>
<li><strong><code>message</code></strong>: (Optional) The email body.</li>
</ul>
<h2 id="schedule-a-reply-for-the-future">Schedule a reply for the future</h2>
<p>Sometimes, you want will to make plans for the future.  That's where <code>self.schedule_say()</code> comes in handy.</p>
<pre><code class="python">@randomly(start_hour='10', end_hour='17', day_of_week=&quot;mon-fri&quot;, num_times_per_day=1)
def walkmaster(self):
    now = datetime.datetime.now()
    in_5_minutes = now + datetime.timedelta(minutes=5)

    self.say(&quot;@all Walk happening in 5 minutes!&quot;)
    self.schedule_say(&quot;@all It's walk time!&quot;, in_5_minutes)
</code></pre>

<p>The options are pretty much the same as <code>self.say</code>, with the addition of the <code>when</code> parameter.</p>
<pre><code class="python">self.schedule_say(content, when, message=None, room=None, html=False, color=&quot;green&quot;, notify=False)
</code></pre>

<ul>
<li><strong><code>content</code></strong>: the content you want to send to the room. Any string will do, HTML or plain text.</li>
<li><strong><code>when</code></strong>: when you want the message to be said. Python <code>datetime</code> object.</li>
<li><strong><code>message</code></strong>: (optional) The incoming message object</li>
<li><strong><code>room</code></strong>: (optional) The room object (from self.available_rooms) to send the message to.</li>
<li><strong><code>html</code></strong>: if the message is HTML. <code>True</code> or <code>False</code>.</li>
<li><strong><code>color</code></strong>: (chat room only) the hipchat color to send. "yellow", "red", "green", "purple", "gray", or "random". Default is "green".</li>
<li><strong><code>notify</code></strong>: whether the message should trigger a 'ping' notification. <code>True</code> or <code>False</code>.</li>
</ul>
<h2 id="set-the-topic">Set the topic</h2>
<p>Sometimes, it's good to give the conversation some direction.  Will can set the topic in hipchat using <code>self.set_topic()</code></p>
<pre><code class="python">import requests

@respond_to(&quot;new topic&quot;)
def give_us_somethin_to_talk_about(self, message):
    r = requests.get(&quot;http://chatoms.com/chatom.json?Normal=1&amp;Fun=2&amp;Philosophy=3&amp;Out+There=4&quot;)
    data = r.json()
    self.set_topic(data[&quot;text&quot;], message=message)
</code></pre>

<p>Note: you can't set the topic of a 1-1 chat. Will will complain politely.  All options:</p>
<pre><code class="python">self.set_topic(topic, message=None, room=None) 
</code></pre>

<ul>
<li><code>topic</code>: The string you want to set the topic to</li>
<li><code>message</code>: (optional) The incoming message object</li>
<li><code>room</code>: (optional) The room object (from self.available_rooms) to send the message to.</li>
</ul>
<h2 id="do-any-python-thing">Do any python thing</h2>
<p>Will is Just Python.  Because of that, your imagination is the limit of what he can do to respond to requests.</p>
<p>Here's a few things our will does, every day:</p>
<ul>
<li>Spins up and tears down staging stacks,</li>
<li>Monitors uptime on our production sites, and contacts the on-call developer if things go down,</li>
<li>Keeps track of code reviews on pending branches,</li>
<li>Add new signups to our CRM,</li>
<li>Starts our daily standup video chat,</li>
<li>And the list goes on.</li>
</ul>
<p>Will is open-source, and PRs are very welcome.  If someone wants to write <code>self.send_sms()</code>, or anything else, it's all yours!</p>
<p>Ready to make some plugins?  Check out <a href="../create/">how to create and organize plugins</a>.</p></div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>